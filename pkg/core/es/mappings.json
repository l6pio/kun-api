{
  "mappings": {
    "properties": {
      "matches": {
        "type": "nested",
        "properties": {
          "artifact": {
            "type": "nested",
            "properties": {
              "name": {
                "type": "keyword"
              },
              "version": {
                "type": "keyword"
              },
              "type": {
                "type": "keyword"
              },
              "locations": {
                "type": "nested",
                "properties": {
                  "path": {
                    "type": "text"
                  },
                  "layerID": {
                    "type": "keyword"
                  }
                }
              },
              "language": {
                "type": "keyword"
              },
              "licenses": {
                "type": "keyword"
              },
              "cpes": {
                "type": "keyword"
              },
              "purl": {
                "type": "text"
              },
              "metadata": {
                "type": "nested",
                "properties": {
                  "VirtualPath": {
                    "type": "text"
                  },
                  "PomArtifactID": {
                    "type": "keyword"
                  },
                  "PomGroupID": {
                    "type": "keyword"
                  }
                }
              }
            }
          },
          "vulnerability": {
            "type": "nested",
            "properties": {
              "id": {
                "type": "keyword"
              },
              "dataSource": {
                "type": "text"
              },
              "namespace": {
                "type": "keyword"
              },
              "severity": {
                "type": "keyword"
              },
              "urls": {
                "type": "text"
              },
              "description": {
                "type": "text"
              },
              "cvss": {
                "type": "nested",
                "properties": {
                  "version": {
                    "type": "keyword"
                  },
                  "metrics": {
                    "type": "nested",
                    "properties": {
                      "baseScore": {
                        "type": "double"
                      },
                      "exploitabilityScore": {
                        "type": "double"
                      },
                      "impactScore": {
                        "type": "double"
                      }
                    }
                  }
                }
              },
              "fix": {
                "type": "nested",
                "properties": {
                  "versions": {
                    "type": "keyword"
                  },
                  "state": {
                    "type": "keyword"
                  }
                }
              }
            }
          }
        }
      },
      "source": {
        "type": "nested",
        "properties": {
          "target": {
            "type": "nested",
            "properties": {
              "userInput": {
                "type": "keyword"
              },
              "imageID": {
                "type": "keyword"
              },
              "imageSize": {
                "type": "long"
              }
            }
          }
        }
      }
    }
  }
}